{% extends "base.html" %}

{% block title %}View Question | StudySpark{% endblock %}

{% block content %}
<style>

  input, textarea, button {
    box-sizing: border-box;
  }
</style>

<div style="max-width: 720px; margin: 40px auto; background: white; padding: 24px; border-radius: 16px; box-shadow: 0 0 15px rgba(0,0,0,0.1);">
  
  {% if question %}
    <h2 style="color: #6a1b9a; font-weight: bold;">🧠 {{ question.topic }}</h2>

    {% if question.image_filename %}
      <img src="{{ url_for('uploaded_image', filename=question.image_filename) }}" alt="Uploaded Image"
           style="max-width: 100%; border-radius: 10px; margin-top: 16px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);" />
    {% endif %}

    {% if question.description %}
      <p style="margin-top: 16px; font-size: 16px; color: #444;">{{ question.description }}</p>
    {% endif %}

    <p style="margin-top: 10px; font-size: 14px; color: #777;">
      Asked by {{ question.user.name if question.user else "Anonymous" }} on {{ question.timestamp.strftime('%d %b %Y') }}
    </p>

    <hr style="margin: 30px 0;" />

    <h3 style="color: #6a1b9a;">💬 Answers</h3>
    {% if answers %}
      {% for ans in answers %}
        <div style="padding: 12px 0; border-bottom: 1px solid #eee;">
          <p style="margin: 0;">{{ ans.answer_text }}</p>
          <p style="font-size: 13px; color: #999;">
            Answered by {{ ans.user.name if ans.user else "Someone" }} on {{ ans.timestamp.strftime('%d %b %Y') }}
          </p>
        </div>
      {% endfor %}
    {% else %}
      <p style="color: #777;">No answers yet. Wanna be the first one to shine? 💡</p>
    {% endif %}

    {% if current_user.is_authenticated %}
      <hr style="margin: 30px 0;" />
      <form method="POST">
        <label style="font-weight: bold;">Your Answer:</label>
        <textarea name="answer_text" required rows="4"
                  style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-top: 10px;"></textarea>
        <button type="submit"
                style="background-color: #6a1b9a; color: white; padding: 10px 20px; border: none; border-radius: 8px; margin-top: 12px;">
          📝 Submit Answer
        </button>
      </form>
    {% else %}
      <p style="margin-top: 20px; color: #999;">Login to post your answer.</p>
    {% endif %}

  {% else %}
    <!-- Ask a new question form -->
    <h2 style="color: #6a1b9a; font-weight: bold;">🧠 Ask a New Question</h2>
    <form method="POST">
      <input type="text" name="topic" placeholder="Question title" required
             style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-top: 10px;"><br>
      <textarea name="description" placeholder="Describe your question" required rows="5"
                style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-top: 10px;"></textarea><br>
      <button type="submit"
              style="background-color: #6a1b9a; color: white; padding: 10px 20px; border: none; border-radius: 8px; margin-top: 12px;">
        📝 Post Question
      </button>
    </form>
  {% endif %}
</div>
{% endblock %}
